
<!DOCTYPE html>
<html>
<head>
<style>
#info {
  position: absolute;
  top: 0px;
  width: 100%;
  padding: 10px;
  text-align: center;
  color: #ffff00;
}
body {
  overflow: hidden;
}
</style>
<head>
    <title>HW2</title>
    <link rel="stylesheet" href="./index.css" />
</head>
<body>
    <div id="stats"></div>
	<script src="https://threejs.org/build/three.min.js"></script>
	<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/109/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r16/Stats.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.3/dat.gui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.2.0/Tween.min.js"></script>
	<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script type="module" src="./index.js"></script>
	 <h6 align="center">
            <font face="Bookman Old Style">WAIKING Steve</font>
        </h6>
	<input type="button" value="FIRST" onclick="ButtonEvent(event);">
    <input type="button" value="THREE" onclick="ButtonEvent(event);">
</body>
<script>

  const scene = new THREE.Scene()
  let camera, renderer,steveObj
  var angle  = 0;
  var clock,stop = 0;
  var mode = 0;

  class Steve{
    constructor() {
      // defined Steve's head, body and foot
      const headGeo = new THREE.BoxGeometry(6, 4, 7)
      const bodyGeo = new THREE.BoxGeometry(6, 10, 4)
      const footGeo = new THREE.BoxGeometry(2, 6, 2)

      const SteveMat = new THREE.MeshPhongMaterial({ color: 0x00ff00 })
      // Phong Material
      // const steveMat = new THREE.MeshPhongMaterial({
      //   color: 0x00FF00
      // })

      // head
      this.head = new THREE.Mesh(headGeo, SteveMat)
      this.head.position.set(0, 12, 0)
	 

      // body
      this.body = new THREE.Mesh(bodyGeo, SteveMat)
      this.body.position.set(0, 6, 0)

      // foot
      this.foot1 = new THREE.Mesh(footGeo, SteveMat)
      this.foot1.position.set(2,0,0)
      this.foot2 = this.foot1.clone()
      this.foot2.position.set(-2,0,0)
  

      // group 4 foot
      this.feet = new THREE.Group()
      this.feet.add(this.foot1)
      this.feet.add(this.foot2)


      // group head, body, feet
      this.steve = new THREE.Group()
      this.steve.add(this.head)
      this.steve.add(this.body)
      this.steve.add(this.feet)
    }
  }

   function init() {
    // 相機設定與 OrbitControls
	
	clock = new THREE.Clock();
    camera = new THREE.PerspectiveCamera(100,window.innerWidth / window.innerHeight,
      0.1,1000
    )
    camera.position.set(0, 200,100)
    camera.lookAt(scene.position)
	//let controls = new THREE.OrbitControls(camera, renderer.domElement);
    // 三軸座標輔助
    let axes = new THREE.AxesHelper(20)
    scene.add(axes)

    // 渲染器設定
    renderer = new THREE.WebGLRenderer()
    renderer.setSize(window.innerWidth, window.innerHeight)
	renderer.setClearColor(0x888888);
    // 簡單的地板
    var gridXZ = new THREE.GridHelper(200, 20, 'red', 'white');
    scene.add(gridXZ);


    createSteve()

    let ambientLight = new THREE.AmbientLight(0x404040) // soft white light
    scene.add(ambientLight)
    let spotLight = new THREE.SpotLight(0xffffff)
    spotLight.position.set(-10, 40, 30)
    scene.add(spotLight)

    // 將渲染出來的畫面放到網頁上的 DOM
    document.body.appendChild(renderer.domElement)
  }
function ButtonEvent(){
  if(cam_mode == 0){
    cam_mode = 1;
  }
  else{
    /*
    camera.position.x = 0;
	camera.position.y = 300;
	camera.position.z = 500; 
	*/
	camera.position.set(0,300,500);
    cam_mode = 0;
  }
}
  function createSteve() {
    steveObj = new Steve()
    scene.add(steveObj.steve)
	steveObj.steve.position.set(0,8,0)
	
  }
let walkOffset = 0

// 苦力怕走動
function steveFeetWalk() {
  walkOffset += 0.04
  
  steveObj.foot1.rotation.x = Math.cos(walkOffset) / 4 // 前腳左
  steveObj.foot2.rotation.x = -Math.cos(walkOffset) / 4 // 後腳左
 
}

function SteveWalk(){

	var radius = 50;
	steveObj.steve.position.set (radius* Math.cos(angle), 5, -radius* Math.sin(angle));
	steveObj.steve.rotation.y = angle;
	var dt = clock.getDelta();
	angle += 2*0.10472*dt;

}

function render() {

	steveFeetWalk()
	SteveWalk()
	
	
	requestAnimationFrame(render)
	renderer.render(scene, camera)
}

var WW = 4;
 function ButtonEvent() {

            var obj = window.event ? event.srcElement : evt.target;
            if (obj.value == "THREE") {
				
				 let cameraPos = new THREE.Vector3(0,12*WW,-50*WW);
				steveObj.head.localToWorld (cameraPos);
				camera.position.copy (cameraPos);
				let cameraLookAt = new THREE.Vector3(0,2*WW,-10);
				steveObj.head.localToWorld (cameraLookAt);
				camera.lookAt (cameraLookAt);
            } else {
                camera = new THREE.PerspectiveCamera(100, window.innerWidth / window.innerHeight,
                    0.1, 1000
                )
                camera.position.set(0, 200, 100)
                camera.lookAt(scene.position)
            }



        }


init()
render()

</script>
</div>
</body>
</html>